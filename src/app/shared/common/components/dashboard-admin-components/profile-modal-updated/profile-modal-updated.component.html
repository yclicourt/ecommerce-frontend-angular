<div
  class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
>
  <div class="bg-gray-700 rounded-lg p-6 w-full max-w-md">
    <h2 class="text-xl font-bold text-white mb-4">Update User Profile</h2>

    <form
      (ngSubmit)="updateProfileChanges()"
      *ngIf="selectedUser"
      #userForm="ngForm"
    >
      <div class="mb-4">
        <label class="block text-white text-sm font-bold mb-2" for="name"
          >Name</label
        >
        <input
          type="text"
          id="name"
          [(ngModel)]="selectedUser.name"
          name="name"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:shadow-outline"
        />
      </div>

      <div class="mb-4">
        <label class="block text-white text-sm font-bold mb-2" for="lastname"
          >Lastname</label
        >
        <input
          type="text"
          id="lastname"
          [(ngModel)]="selectedUser.lastname"
          name="lastname"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:shadow-outline"
        />
      </div>

      <div class="mb-4">
        <label class="block text-white text-sm font-bold mb-2" for="email"
          >Email</label
        >
        <input
          type="email"
          id="email"
          [(ngModel)]="selectedUser.email"
          name="email"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:shadow-outline"
        />
      </div>

      <div class="mb-4">
        <label class="block text-white text-sm font-bold mb-2" for="role"
          >Role</label
        >
        <div *ngFor="let role of [Role.USER, Role.ADMIN]">
          <label class="text-white">
            <input
              type="checkbox"
              [checked]="selectedUser.role?.includes(role)"
              (change)="toggleRole(role)"
            />
            {{ role }}
          </label>
        </div>
      </div>

      <div class="mb-4">
        <label class="block text-white text-sm font-bold mb-2" for="phone"
          >Phone</label
        >
        <input
          type="text"
          id="phone"
          [(ngModel)]="selectedUser.phone"
          name="phone"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:shadow-outline"
        />
      </div>

      <div class="mb-4">
        <label class="block text-white text-sm font-bold mb-2" for="address"
          >Address</label
        >
        <input
          type="text"
          id="address"
          [(ngModel)]="selectedUser.address"
          name="address"
          class="shadow appearance-none border rounded w-full py-2 px-3 text-white leading-tight focus:outline-none focus:shadow-outline"
        />
      </div>
      <div class="mb-4">
        <label class="block text-white text-sm font-bold mb-2">Avatar</label>
        <input
          type="file"
          (change)="onFileSelected($event)"
          accept="image/*"
          class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
        />
        <img
          *ngIf="selectedUser?.avatar"
          [src]="avatarPreview || selectedUser.avatar || '/avatar.svg'"
          class="mt-2 h-20 w-20 rounded-full object-cover"
        />
      </div>

      <div class="flex justify-end space-x-4">
        <button
          type="button"
          (click)="closeUpdateModal()"
          class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded"
        >
          Cancel
        </button>
        <button
          type="submit"
          class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"
          [disabled]="isUpdating"
        >
          <span *ngIf="!isUpdating">Update</span>
          <span *ngIf="isUpdating">Updating...</span>
        </button>
      </div>
    </form>
  </div>
</div>
